<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prime Sequence Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gradient-to-br from-slate-900 via-[#1e1b4b] to-[#4c1d95]">
    <div id="root"></div>
    <script type="text/babel">
      // --- From services/primeService.ts ---
      const isPrime = (num) => {
        if (num <= 1) return false;
        if (num <= 3) return true;
        if (num % 2 === 0 || num % 3 === 0) return false;
        for (let i = 5; i * i <= num; i = i + 6) {
          if (num % i === 0 || num % (i + 2) === 0) return false;
        }
        return true;
      };

      const generatePrimes = (n) => {
        if (n <= 0) return [];
        const primes = [];
        let num = 2;
        while (primes.length < n) {
          if (isPrime(num)) {
            primes.push(num);
          }
          num++;
        }
        return primes;
      };

      // --- From components/Icons.tsx ---
      const DownloadIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
          <path strokeLinecap="round" strokeLinejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
        </svg>
      );

      const LoadingSpinner = () => (
          <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
              <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
      );

      const LockIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
              <path strokeLinecap="round" strokeLinejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
          </svg>
      );

      const UnlockIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
          <path strokeLinecap="round" strokeLinejoin="round" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" />
        </svg>
      );
      
      // --- From App.tsx ---
      const App = () => {
        const { useState, useCallback } = React;

        const [n, setN] = useState('100');
        const [primes, setPrimes] = useState([]);
        const [isLoading, setIsLoading] = useState(false);
        const [error, setError] = useState(null);
        const [isLimitUnlocked, setIsLimitUnlocked] = useState(false);

        const handleGeneratePrimes = useCallback(() => {
          setError(null);
          const num = parseInt(n, 10);

          if (isNaN(num) || num <= 0) {
            setError('Please enter a positive integer.');
            setPrimes([]);
            return;
          }

          if (!isLimitUnlocked && num > 1000000) {
            setError('Limit of 1,000,000 exceeded. Please unlock the limit for larger numbers.');
            setPrimes([]);
            return;
          }

          setIsLoading(true);
          setPrimes([]);

          setTimeout(() => {
            try {
              const result = generatePrimes(num);
              const formattedPrimes = result.map((prime, index) => ({
                n: index + 1,
                prime: prime,
              }));
              setPrimes(formattedPrimes);
            } catch (e) {
              setError('An error occurred while generating primes.');
              console.error(e);
            } finally {
              setIsLoading(false);
            }
          }, 50);
        }, [n, isLimitUnlocked]);

        const handleDownloadJson = useCallback(() => {
          if (primes.length === 0) return;

          const jsonString = JSON.stringify(primes, null, 2);
          const blob = new Blob([jsonString], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `primes_${primes.length}.json`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }, [primes]);

        return (
          <div className="min-h-screen text-slate-100 flex items-center justify-center p-4 font-sans">
            <div className="w-full max-w-2xl bg-black/30 backdrop-blur-xl border border-purple-500/30 rounded-2xl shadow-2xl shadow-purple-500/20 p-6 md:p-8 space-y-6">
              
              <header className="text-center">
                <h1 className="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-violet-400 to-cyan-300">
                  Prime Sequence Generator
                </h1>
                <p className="text-indigo-300/80 mt-2">Generate the first 'n' prime numbers and download them.</p>
              </header>

              <div className="flex flex-col sm:flex-row items-center gap-4">
                <input
                  type="number"
                  value={n}
                  onChange={(e) => setN(e.target.value)}
                  placeholder="e.g., 100"
                  className="flex-grow w-full bg-slate-900/50 border-2 border-indigo-700/50 rounded-lg p-3 text-lg text-white placeholder-slate-500 focus:outline-none focus:ring-4 focus:ring-violet-500/50 focus:border-violet-500 transition-all duration-300"
                  min="1"
                  max={isLimitUnlocked ? undefined : "1000000"}
                  aria-label="Number of primes to generate"
                />
                <button
                  onClick={handleGeneratePrimes}
                  disabled={isLoading}
                  className="w-full sm:w-auto flex items-center justify-center bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 disabled:bg-slate-500 disabled:from-slate-500 disabled:to-slate-600 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg text-lg transition-all duration-300 transform hover:scale-105 active:scale-95 shadow-lg shadow-indigo-500/40"
                >
                  {isLoading ? (
                    <React.Fragment>
                      <LoadingSpinner />
                      Generating...
                    </React.Fragment>
                  ) : 'Generate'}
                </button>
              </div>
              
              <div className="flex flex-col items-center justify-center gap-3">
                  <button 
                      onClick={() => setIsLimitUnlocked(prev => !prev)}
                      className={`flex items-center justify-center bg-transparent border-2 font-bold py-2 px-5 rounded-lg text-sm transition-all duration-300 transform hover:scale-105 active:scale-95 shadow-lg ${
                          isLimitUnlocked 
                          ? 'border-green-500/60 hover:bg-green-500/20 text-green-400 shadow-green-500/20' 
                          : 'border-amber-500/60 hover:bg-amber-500/20 text-amber-400 shadow-amber-500/20'
                      }`}
                      aria-label={isLimitUnlocked ? "Lock generation limit" : "Unlock generation limit"}
                  >
                      {isLimitUnlocked ? <UnlockIcon /> : <LockIcon />}
                      {isLimitUnlocked ? 'Limit Unlocked' : 'Unlock Limit'}
                  </button>
                  {isLimitUnlocked && (
                      <p className="text-amber-400/80 text-xs text-center max-w-md">
                          Warning: Generating very large sequences may be slow or cause the browser to become unresponsive.
                      </p>
                  )}
              </div>

              {error && <p className="text-red-300 text-center bg-red-500/20 border border-red-500/30 p-3 rounded-lg">{error}</p>}
              
              {primes.length > 0 && !isLoading && (
                <div className="bg-black/20 p-4 rounded-lg space-y-4 border border-indigo-900/50">
                  <div className="flex flex-col sm:flex-row justify-between items-center gap-4">
                    <h2 className="text-xl font-semibold text-violet-300">
                      Generated {primes.length} Prime{primes.length > 1 ? 's' : ''}
                    </h2>
                    <button
                      onClick={handleDownloadJson}
                      className="flex items-center bg-cyan-500/10 border border-cyan-400/50 hover:bg-cyan-500/20 text-cyan-300 font-semibold py-2 px-4 rounded-lg transition-colors duration-300 shadow-md w-full sm:w-auto justify-center"
                    >
                      <DownloadIcon />
                      Download JSON
                    </button>
                  </div>
                  <div className="max-h-64 overflow-y-auto p-3 bg-black/20 rounded-md border border-indigo-900/50">
                    <p className="text-cyan-300 leading-relaxed font-mono break-words">
                      {primes.map(p => p.prime).join(', ')}
                    </p>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };

      // --- From index.tsx ---
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }
      const root = ReactDOM.createRoot(rootElement);
      root.render(
        <React.StrictMode>
          <App />
        </React.StrictMode>
      );
    </script>
  </body>
</html>